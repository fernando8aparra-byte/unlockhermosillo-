<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desbloqueo tu iPhone</title>
    <!-- Fuentes -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
    <link rel="stylesheet" href="https://sf.abarba.me/SF.css">
    <!-- Iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
        import { getStorage, ref, listAll, getDownloadURL, getMetadata } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-storage.js";
        const firebaseConfig = {
            apiKey: "AIzaSyAt8TuulnlY3IKPaFVctgaGNQWewfzONEI",
            authDomain: "comprobantes-363c9.firebaseapp.com",
            databaseURL: "https://comprobantes-363c9-default-rtdb.firebaseio.com",
            projectId: "comprobantes-363c9",
            storageBucket: "comprobantes-363c9.firebasestorage.app",
            messagingSenderId: "390391998056",
            appId: "1:390391998056:web:23e22073d88bc247d43ddd",
            measurementId: "G-8W03RJD0TZ"
        };
        const app = initializeApp(firebaseConfig);
        const storage = getStorage(app);

        // Cargar slider principal
        async function loadMainSlider() {
            const folderRef = ref(storage, 'slider');
            const sliderInner = document.querySelector('#main-slider .slider-inner');
            try {
                const listResult = await listAll(folderRef);
                if (listResult.items.length === 0) {
                    sliderInner.innerHTML = '<div class="slider-item active"><div class="placeholder">No hay im√°genes en el slider</div></div>';
                    return;
                }
                listResult.items.forEach(async (itemRef, index) => {
                    const url = await getDownloadURL(itemRef);
                    const metadata = await getMetadata(itemRef);
                    const div = document.createElement('div');
                    div.className = 'slider-item' + (index === 0 ? ' active' : '');
                    let content = '';
                    if (metadata.contentType.startsWith('video/')) {
                        content = `<video src="${url}" autoplay muted loop playsinline></video>`;
                    } else {
                        content = `<img src="${url}" alt="Slider ${index + 1}" loading="lazy">`;
                    }
                    div.innerHTML = content;
                    sliderInner.appendChild(div);
                });
            } catch (error) {
                console.error("Error cargando slider:", error);
                sliderInner.innerHTML = '<div class="slider-item active"><div class="placeholder">Error al cargar slider</div></div>';
            }
        }

        // Cargar carruseles de trabajos recientes
        async function loadCarousel(folder, carouselId) {
            const folderRef = ref(storage, folder);
            const carouselInner = document.querySelector(`#${carouselId} .carousel-inner`);
            carouselInner.innerHTML = '';
            try {
                const listResult = await listAll(folderRef);
                if (listResult.items.length === 0) {
                    carouselInner.innerHTML = '<div class="carousel-item active"><div class="fb-image-placeholder">No hay contenido disponible</div></div>';
                    return;
                }
                listResult.items.forEach(async (itemRef, index) => {
                    const url = await getDownloadURL(itemRef);
                    const metadata = await getMetadata(itemRef);
                    const div = document.createElement('div');
                    div.className = 'carousel-item' + (index === 0 ? ' active' : '');
                    let content = '';
                    if (metadata.contentType.startsWith('video/')) {
                        content = `<video src="${url}" controls preload="metadata" playsinline></video>`;
                    } else {
                        content = `<img src="${url}" alt="Trabajo reciente" loading="lazy">`;
                    }
                    div.innerHTML = content + '<div class="fb-image-placeholder">Contenido no disponible</div>';
                    carouselInner.appendChild(div);
                });
            } catch (error) {
                console.error("Error cargando carrusel:", error);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const mainContent = document.getElementById('main-content');
            loadMainSlider(); // Cargar slider principal siempre

            const observer = new MutationObserver(() => {
                if (mainContent.classList.contains('visible')) {
                    loadCarousel('ads-1', 'carousel-1');
                    loadCarousel('ads-2', 'carousel-2');
                    observer.disconnect();
                }
            });
            observer.observe(mainContent, { attributes: true, attributeFilter: ['class'] });
            if (mainContent.classList.contains('visible')) {
                loadCarousel('ads-1', 'carousel-1');
                loadCarousel('ads-2', 'carousel-2');
            }

            // Flechita gu√≠a primera vez
            if (!localStorage.getItem('guiaVista')) {
                document.getElementById('guia-flecha').classList.add('visible');
            }
            document.body.addEventListener('click', () => {
                document.getElementById('guia-flecha').classList.remove('visible');
                localStorage.setItem('guiaVista', 'true');
            }, { once: true });
            window.addEventListener('scroll', () => {
                if (window.scrollY > 200) {
                    document.getElementById('guia-flecha').classList.remove('visible');
                    localStorage.setItem('guiaVista', 'true');
                }
            });
        });
    </script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'SF Pro Display', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: #f5f5f7;
            color: #1d1d1f;
            overflow-x: hidden;
        }

        /* Header fijo */
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .hamburger {
            position: absolute;
            left: 20px;
            font-size: 28px;
            color: #1d1d1f;
            cursor: pointer;
        }
        .header-title {
            font-size: 24px;
            font-weight: 700;
            color: #1d1d1f;
        }

        /* Navegaci√≥n ovalada */
        .nav-oval {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            padding: 20px;
            margin-top: 80px;
        }
        .nav-item {
            background: white;
            padding: 12px 28px;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        .nav-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        /* Slider principal (nuevo) */
        #main-slider {
            width: 100%;
            overflow: hidden;
            position: relative;
            margin: 40px 0;
        }
        .slider-inner {
            display: flex;
            transition: transform 0.6s ease;
        }
        .slider-item {
            min-width: 100%;
            position: relative;
        }
        .slider-item img, .slider-item video {
            width: 100%;
            height: auto;
            max-height: 70vh;
            object-fit: cover;
            display: block;
        }
        .placeholder {
            width: 100%;
            height: 400px;
            background: #eee;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 20px;
        }

        /* Secciones */
        section {
            padding: 60px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        h2 {
            text-align: center;
            font-size: 32px;
            margin-bottom: 40px;
        }

        /* Preview / Trabajos recientes */
        #preview {
            position: relative;
        }
        #preview .posts-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-bottom: 60px;
        }
        @media (min-width: 768px) {
            #preview .posts-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        .fb-carousel-container {
            background: white;
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        .fb-carousel-container:hover {
            transform: translateY(-6px);
            box-shadow: 0 16px 40px rgba(0,0,0,0.15);
        }
        .fb-header {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            cursor: pointer;
        }
        .fb-profile-pic {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e4e6eb;
            margin-right: 12px;
        }
        .fb-name-time { flex: 1; }
        .fb-name { font-weight: 600; font-size: 15px; color: #1c1e21; }
        .fb-time { font-size: 13px; color: #65676b; }
        .fb-content {
            padding: 0 16px 12px;
            font-size: 15px;
            color: #1c1e21;
        }
        .carousel-container {
            position: relative;
            width: 100%;
            background: #000;
            overflow: hidden;
        }
        .carousel-inner {
            display: flex;
            width: 100%;
            height: 100%;
            transition: transform 0.5s ease;
        }
        .carousel-item {
            min-width: 100%;
            position: relative;
        }
        .carousel-item img, .carousel-item video {
            width: 100%;
            height: 100%;
            object-fit: contain; /* Ahora se ve completa la imagen/video */
            background: black;
            display: block;
        }
        .fb-image-placeholder {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            font-size: 18px;
        }

        /* Flechita gu√≠a */
        #guia-flecha {
            position: absolute;
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
            background: #1d1d1f;
            color: white;
            padding: 15px 20px;
            border-radius: 50px;
            font-weight: 600;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
            z-index: 10;
        }
        #guia-flecha::after {
            content: '';
            position: absolute;
            top: 50%;
            right: -15px;
            transform: translateY(-50%) rotate(45deg);
            width: 20px;
            height: 20px;
            background: #1d1d1f;
        }
        #guia-flecha.visible {
            opacity: 1;
        }

        /* Otras secciones */
        #nosotros, #servicios, #resenas, #faq, #info-dispositivos {
            background: white;
            padding: 40px;
            border-radius: 18px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }

        .cta-container {
            text-align: center;
            margin: 60px 0;
        }
        .cta-button {
            background: #1d1d1f;
            color: white;
            padding: 20px 56px;
            font-size: 26px;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }
        .cta-button:hover {
            background: #000;
            transform: translateY(-3px);
        }

        /* T√©rminos */
        #terms-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            transition: opacity 0.8s ease;
        }
        #terms-screen.hidden { opacity: 0; pointer-events: none; }
        .terms-card {
            background: rgba(255,255,255,0.9);
            padding: 40px;
            border-radius: 18px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 8px 32px rgba(0,0,0,0.12);
            text-align: center;
        }

        main { margin-top: 80px; }
    </style>
</head>
<body>

    <!-- Header fijo -->
    <header>
        <div class="hamburger" id="hamburger">‚ò∞</div>
        <div class="header-title">Desbloqueo tu iPhone</div>
    </header>

    <!-- T√©rminos primera vez -->
    <div id="terms-screen">
        <div class="terms-card">
            <h2>T√©rminos y Condiciones</h2>
            <p>Al utilizar este servicio, usted declara que:</p>
            <ul style="text-align:left;">
                <li>El tel√©fono iPhone es de su propiedad exclusiva.</li>
                <li>Entiende que cualquier procedimiento conlleva riesgos.</li>
                <li>El t√©cnico no se responsabiliza por da√±os o p√©rdida de datos.</li>
                <li>Usted asume completa responsabilidad.</li>
            </ul>
            <div style="margin:20px 0;">
                <input type="checkbox" id="accept-checkbox">
                <label for="accept-checkbox">Acepto los t√©rminos y condiciones</label>
            </div>
            <button id="accept-btn" disabled>Aceptar y continuar</button>
        </div>
    </div>

    <!-- Navegaci√≥n ovalada -->
    <div class="nav-oval">
        <div class="nav-item" onclick="document.getElementById('nosotros').scrollIntoView({behavior:'smooth'})">Nosotros</div>
        <div class="nav-item" onclick="document.getElementById('servicios').scrollIntoView({behavior:'smooth'})">Servicios</div>
        <div class="nav-item" onclick="document.getElementById('preview').scrollIntoView({behavior:'smooth'})">Rese√±as</div>
        <div class="nav-item" onclick="document.getElementById('faq').scrollIntoView({behavior:'smooth'})">Preguntas frecuentes</div>
    </div>

    <!-- Slider principal (nuevo) -->
    <div id="main-slider">
        <div class="slider-inner"></div>
    </div>

    <main id="main-content">

        <!-- Secci√≥n Preview / Trabajos recientes -->
        <section id="preview" style="position:relative;">
            <div id="guia-flecha">Mira el proceso de desbloqueo aqu√≠ ‚Üí</div>
            <h2>Trabajos recientes</h2>
            <div class="posts-grid">
                <div class="fb-carousel-container">
                    <div class="fb-header" onclick="window.open('https://www.instagram.com/ferv_hs', '_blank')">
                        <div class="fb-profile-pic"></div>
                        <div class="fb-name-time">
                            <div class="fb-name">ferv_hs</div>
                            <div class="fb-time">Trabajo reciente</div>
                        </div>
                    </div>
                    <div class="fb-content">¬°Otro iPhone desbloqueado con √©xito! üöÄ</div>
                    <div class="carousel-container" id="carousel-1">
                        <div class="carousel-inner"></div>
                    </div>
                </div>
                <div class="fb-carousel-container">
                    <div class="fb-header" onclick="window.open('https://www.instagram.com/ferv_hs', '_blank')">
                        <div class="fb-profile-pic"></div>
                        <div class="fb-name-time">
                            <div class="fb-name">ferv_hs</div>
                            <div class="fb-time">Trabajo reciente</div>
                        </div>
                    </div>
                    <div class="fb-content">¬°Otro iPhone desbloqueado con √©xito! üöÄ</div>
                    <div class="carousel-container" id="carousel-2">
                        <div class="carousel-inner"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Placeholders para que escribas despu√©s -->
        <section id="nosotros">
            <h2>Nosotros</h2>
            <p>Aqu√≠ escribe tu texto sobre el equipo, experiencia, etc.</p>
        </section>

        <section id="servicios">
            <h2>Servicios</h2>
            <p>Aqu√≠ describe los servicios que ofreces.</p>
        </section>

        <section id="resenas">
            <h2>Rese√±as</h2>
            <p>Aqu√≠ puedes agregar rese√±as de clientes o m√°s carruseles.</p>
        </section>

        <section id="faq">
            <h2>Preguntas frecuentes</h2>
            <p>Aqu√≠ pon el acorde√≥n o lista de preguntas.</p>
        </section>

        <section id="info-dispositivos">
            <h2>C√≥mo quedan los dispositivos</h2>
            <p>Aqu√≠ escribe toda la informaci√≥n honesta sobre c√≥mo quedan los iPhone seg√∫n modelo, riesgos, qu√© no prometer, etc.</p>
        </section>

        <div class="cta-container">
            <button class="cta-button" onclick="window.location.href='crea-cita.html'">¬°Agenda ahora tu desbloqueo!</button>
        </div>

    </main>

    <footer>
        <p>¬© 2025 Todos los derechos reservados.</p>
        <a href="https://www.instagram.com/ferv_hs" target="_blank" class="instagram-link">
            <i class="fab fa-instagram"></i>
        </a>
    </footer>

    <script>
        // T√©rminos
        const termsScreen = document.getElementById('terms-screen');
        const checkbox = document.getElementById('accept-checkbox');
        const acceptBtn = document.getElementById('accept-btn');
        const mainContent = document.getElementById('main-content');

        if (localStorage.getItem('termsAccepted') === 'true') {
            termsScreen.classList.add('hidden');
            mainContent.classList.add('visible');
        }
        checkbox.addEventListener('change', () => acceptBtn.disabled = !checkbox.checked);
        acceptBtn.addEventListener('click', () => {
            if (checkbox.checked) {
                localStorage.setItem('termsAccepted', 'true');
                termsScreen.classList.add('hidden');
                setTimeout(() => mainContent.classList.add('visible'), 300);
            }
        });
    </script>
</body>
</html>
